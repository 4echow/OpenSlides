{% extends "agenda/base_agenda.html" %}

{% load tags %}
{% load i18n %}
{% load mptt_tags %}
{% load staticfiles %}

{% block title %}{{ block.super }} - {% trans "Agenda" %}{% endblock %}

{% block header %}
    <link type="text/css" rel="stylesheet" media="all" href="{% static 'styles/tabledrag.css' %}" />
    <link type="text/css" rel="stylesheet" media="all" href="{% static 'styles/agenda.css' %}" />
    {% if perms.agenda.can_manage_agenda %}
        <script type="text/javascript" src="{% static 'javascript/jquery.once.js' %}"></script>
        <script type="text/javascript" src="{% static 'javascript/jquery.cookie.js' %}"></script>
        <script type="text/javascript" src="{% static 'javascript/jquery.tmpl.js' %}"></script>
        <script type="text/javascript" src="{% static 'javascript/tabledrag.js' %}"></script>
        <script type="text/javascript" src="{% static 'javascript/agenda.js' %}"></script>

        <script type="text/javascript">
        <!--//--><![CDATA[//><!--
        //This is Drupal Code
        jQuery.extend(
          Drupal.settings,
        {
        "tableDrag":
          { "menu-overview":
            { "menu-plid":
              [ { "target": "menu-plid", "source": "menu-mlid", "relationship": "parent", "action": "match", "hidden": true, "limit": 8 } ],
              "menu-weight":
              [ { "target": "menu-weight", "source": "menu-weight", "relationship": "sibling", "action": "order", "hidden": true, "limit": 0 } ]
            }
          }
        });
        //--><!]]>
    </script>
    {% endif %}
{% endblock %}


{% block content %}
    <h1>{% trans "Agenda" %}</h1>
    {% if items %}
        <form action="/agenda/" method="post">{% csrf_token %}
            {% if perms.agenda.can_manage_agenda %}
            <div id="changed-order-message" style="display:none" class="notification warning">
                <em>{% trans "Do you want to save the changed order of agenda items?" %}<br>
                    <input type="submit" value="{% trans 'Yes' %}">
                    <input type="button" onclick="window.location.href='{% url item_overview %}';" value="{%trans 'No' %}">
                </em>
            </div>
            {% endif %}

            <table id="menu-overview" class="agendatable">
                <tr>
                    <th style="width: 1px;">{% trans "Done" %}</th>
                    <th>{% trans "Item" %}</th>
                    <th style="width: 1px;">{% if perms.agenda.can_manage_agenda %}{% trans "Actions" %}{% endif %}</th>
                    {% if perms.agenda.can_manage_agenda %}
                        <th class="tabledrag-hide">{% trans "Weight" %}</th>
                    {% endif %}
                </tr>
                <tr class="topline {% if overview %}activeline{% endif %}">
                    <td></td>
                    <td>
                        <b>{% trans "Agenda" %} ({{ items|length }} {% trans "items" %}<span id="hiddencount"></span>)</b>
                    </td>
                    <td>
                        <span id="action_field" style="width: 1px; white-space: nowrap;">
                            <span></span>
                        </span>
                    </td>
                </tr>

                {% for item in items %}
                    {% include "agenda/item_row.html" %}
                {% endfor %}
            </table>
        </form>
    {% else %}
        <i>{% trans "No items available." %}</i>
    {% endif %}
{% endblock %}
