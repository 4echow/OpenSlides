{% extends "projector/base_projector.html" %}

{% load tags %}
{% load i18n %}
{% load staticfiles %}

{% block header %}
    <link type="text/css" href="{% static 'styles/ui-lightness/jquery-ui-1.8.18.custom.css' %}" rel="stylesheet" />
    <link type="text/css" rel="stylesheet" media="all" href="{% static 'styles/projector-control.css' %}" />
    <script type="text/javascript" src="{% static 'javascript/jquery-ui-1.8.18.custom.min.js' %}"></script>
    <script type="text/javascript" src="{% static 'javascript/projector-control.js' %}"></script>
    <script type="text/javascript" src="{% static 'javascript/jquery.cookie.js' %}"></script>
    <script type="text/javascript">
    $(function() {
        $( ".column" ).sortable({
            connectWith: ".column"
        });
        $( ".portlet" ).addClass( "ui-widget ui-widget-content ui-helper-clearfix ui-corner-all" )
            .find( ".portlet-header" )
                .addClass( "ui-widget-header ui-corner-all" )
                .prepend( "<span class='ui-icon ui-icon-minusthick'></span>")
                .end()
            .find( ".portlet-content" );
        $( ".portlet-header .ui-icon" ).click(function() {
            $( this ).toggleClass( "ui-icon-minusthick" ).toggleClass( "ui-icon-plusthick" );
            $( this ).parents( ".portlet:first" ).find( ".portlet-content" ).toggle();
        });
        $( ".column" ).disableSelection();
        $( "document" ).ready(function(){
            if ($.browser.msie) {
                $( "#iframe" ).css('zoom', '0.25');
            }
        });
    });
    </script>


{% endblock %}

{% block content %}
    <h1>{% trans 'Projector' %}</h1>
    <form action="" method="post">{% csrf_token %}
        <input name='message_text' type='text' value="{% get_config 'projector_message' %}">
        <button type="submit" class="button" name='message'><span class="icon ok">{% trans 'Save' %}</span></button>
        <button type="submit" class="button" name='message-clean'><span class="icon cancel">{% trans 'Clean' %}</span></button>
    </form>
    <div style="text-align: right; padding: 0 10px 5px 0; margin-top:-20px;">
        <!-- projector control -->
        {% trans "Adjust projector view" %}:
        <a class="projector_edit" href="{% url projector_bigger %}" title="{% trans 'Zoom in' %}">
            <img src="{% static 'images/icons/zoom-in.png' %}" />
        </a>
        <a class="projector_edit" href="{% url projector_smaller %}" title="{% trans 'Zoom out' %}">
            <img src="{% static 'images/icons/zoom-out.png' %}" />
        </a>
        <a class="projector_edit" href="{% url projector_up %}" title="{% trans 'Scroll text up' %}">
            <img src="{% static 'images/icons/go-up.png' %}" />
        </a>
        <a class="projector_edit" href="{% url projector_down %}" title="{% trans 'Scroll text down' %}">
            <img src="{% static 'images/icons/go-down.png' %}" />
        </a>
        <a class="projector_edit" href="{% url projector_clean %}" title="{% trans 'Reset projector view' %}">
            <img src="{% static 'images/icons/view-restore.png' %}" />
        </a>
    </div>

    <div class="column">
    {% for category, group in categories.items %}
        {% if category != 'projector' %}
        <div class="portlet">
            {% with category_big=category|capfirst %}
            <div class="portlet-header">{% trans  category_big %}</div>
            {% endwith %}
            <div class="portlet-content">
            {% for slides in group %}
                {% if slides.control_template %}
                    {% include slides.control_template %}
                {% endif %}
                {% if not forloop.last %}
                    <hr>
                {% endif %}
            {% endfor %}
            </div>
        </div> <!-- end portlet-->
       {% endif %}
    {% endfor %}
    </div> <!-- end column-->

    <div class="column">
        <!-- Projector Live View -->
        <div class="portlet">
            <div class="portlet-header">
                {% trans "Projector Live View" %}
            </div>
            <div class="portlet-content">
                <a href="{% url projector_show %}" target="_blank" title="{% trans 'Open Projector view' %}" >
                <div id="iframewrapper">
                    <iframe id="iframe" src="{% url projector_show %}" frameborder="0"></iframe>
                    <div id="iframeoverlay"></div>
                </div>
                </a>
            </div>
        </div> <!-- end portlet-->

        <!-- Overlays (Countdown etc.)-->
        <div class="portlet">
            <div class="portlet-header">{% trans 'Overlays' %}</div>
            <div class="portlet-content">
                <ul style="line-height: 180%">
                <form action="" method="post">{% csrf_token %}
                    <ul>
                    {% for overlay in overlays %}
                        <li>
                            <input type="checkbox" name="{{ overlay }}" onchange="submit()"
                            {% if overlay.active %} checked="checked"{% endif %}> {{ overlay }}
                            {% if overlay.def_name == "Countdown" %}
                                |
                                <a href="{% url config_agenda %}">{{countdown_time}}{% trans "sec" %}</a>
                                <a class="projector_countdown" href="{% url countdown_reset %}" title="{% trans 'Reset countdown' %}">
                                    <img src="{% static 'images/icons/media-skip-backward.png' %}" />
                                </a>
                                <a class="projector_countdown" href="{% url countdown_start %}" title="{% trans 'Start countdown' %}">
                                    <img src="{% static 'images/icons/media-playback-start.png' %}" />
                                </a>
                                <a class="projector_countdown" href="{% url countdown_stop %}" title="{% trans 'Stop countdown' %}">
                                    <img src="{% static 'images/icons/media-playback-pause.png' %}" />
                                </a>
                            {% endif %}
                        </li>
                    {% endfor %}
                    </ul>
                </form>
                </ul>
            </div>
        </div> <!-- end portlet-->
    </div> <!-- end column -->
{% endblock %}
