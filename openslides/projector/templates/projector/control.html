{% extends "projector/base_projector.html" %}

{% load tags %}
{% load i18n %}

{% block header %}
    <link type="text/css" href="/static/styles/ui-lightness/jquery-ui-1.8.18.custom.css" rel="stylesheet" />
    <link type="text/css" rel="stylesheet" media="all" href="/static/styles/agenda.css" />
    <script type="text/javascript" src="/static/javascript/jquery-ui-1.8.18.custom.min.js"></script>
    <script type="text/javascript" src="/static/javascript/projector-control.js"></script>
    <script type="text/javascript" src="/static/javascript/jquery.cookie.js"></script>
    <script type="text/javascript">
        $(function(){
            $("#accordion").accordion({ header: "h2" });
        });
    </script>
    <style>
    .column { width: 50%; float: left; padding-bottom: 0px; }
    .portlet { margin: 0 1em 1em 0; }
    .portlet-header { margin: 0.3em; padding-bottom: 4px; padding-left: 0.2em; }
    .portlet-header .ui-icon { float: right; }
    .portlet-content { padding: 0.4em; overflow: hidden; }
    .ui-sortable-placeholder { border: 1px dotted black; visibility: visible !important; height: 50px !important; }
    .ui-sortable-placeholder * { visibility: hidden; }
    </style>
    <script>
    $(function() {
        $( ".column" ).sortable({
            connectWith: ".column"
        });

        $( ".portlet" ).addClass( "ui-widget ui-widget-content ui-helper-clearfix ui-corner-all" )
            .find( ".portlet-header" )
                .addClass( "ui-widget-header ui-corner-all" )
                .prepend( "<span class='ui-icon ui-icon-minusthick'></span>")
                .end()
            .find( ".portlet-content" );

        $( ".portlet-header .ui-icon" ).click(function() {
            $( this ).toggleClass( "ui-icon-minusthick" ).toggleClass( "ui-icon-plusthick" );
            $( this ).parents( ".portlet:first" ).find( ".portlet-content" ).toggle();
        });

        $( ".column" ).disableSelection();
    });
    </script>


{% endblock %}

{% block content %}
    <h1>{% trans 'Projector' %}</h1>
    <div style="text-align: right; padding: 0 5px 5px 0; margin-top:-20px;">
        <!-- countdown -->
        <input type="checkbox" name="countdown" onchange="document.location='{% if countdown_visible %}{% url countdown_close %}{% else %}{% url countdown_open %}{% endif %}'"{% if countdown_visible %} checked{% endif %}>
        {% trans "Countdown" %} (<a href="{% url config_agenda %}">{{countdown_time}}{% trans "sec" %}</a>)
        {% if countdown_visible %}:
            <a class="projector_countdown" href="{% url countdown_reset %}" title="{% trans 'Reset countdown' %}">
                <img src="/static/images/icons/media-skip-backward.png" />
            </a>
            <a class="projector_countdown" href="{% url countdown_start %}" title="{% trans 'Start countdown' %}">
                <img src="/static/images/icons/media-playback-start.png" />
            </a>
            <a class="projector_countdown" href="{% url countdown_stop %}" title="{% trans 'Stop countdown' %}">
                <img src="/static/images/icons/media-playback-pause.png" />
            </a>
        {% endif %}
        <p></p>
        <!-- projector control -->
        {% trans "Adjust projector view" %}:
        <a class="projector_edit" href="{% url projector_bigger %}" title="{% trans 'Zoom in' %}">
            <img src="/static/images/icons/zoom-in.png" />
        </a>
        <a class="projector_edit" href="{% url projector_smaller %}" title="{% trans 'Zoom out' %}">
            <img src="/static/images/icons/zoom-out.png" />
        </a>
        <a class="projector_edit" href="{% url projector_up %}" title="{% trans 'Scroll text up' %}">
            <img src="/static/images/icons/go-up.png" />
        </a>
        <a class="projector_edit" href="{% url projector_down %}" title="{% trans 'Scroll text down' %}">
            <img src="/static/images/icons/go-down.png" />
        </a>
        <a class="projector_edit" href="{% url projector_clean %}" title="{% trans 'Reset projector view' %}">
            <img src="/static/images/icons/view-restore.png" />
        </a>
    </div>


    {% for category, slides in categories.items %}
    <div class="column">
        <div class="portlet">
            <div class="portlet-header">{{ category }}</div>
            <div class="portlet-content">
            {% for slide in slides %}
                {% if slide.model_slide %}
                    <ul style="line-height: 180%">
                    {% for item in slide.get_items %}
                        <li><a href="{% url projector_activate_slide item.sid %}" 
                        {% if item.active %}
                            class="inactivate_link"
                        {% else %}
                            class="activate_link"
                        {% endif %}
                        ><div></div></a>{{ item }}</li>
                    {% endfor %}
                    </ul>
                {% else %}
                    <a href="{% url projector_activate_slide slide.key %}"
                            class="activate_link"
                    ><div></div></a>{{ slide.key }}
                {% endif %}
            {% endfor %}
            </div>
        </div>
    </div>
    {% endfor %}

    <div class="column">
        <div class="portlet">
            <div class="portlet-header">
                {% trans "Projector Live View" %}
            </div>
            <div class="portlet-content">
                <div id="iframewrapper">
                <iframe id="iframe" src="{% url projector_show %}"></iframe>
                </div>
            </div>
        </div>
        <div class="portlet">
            <div class="portlet-header">{% trans "Hidden information" %}</div>
            <div class="portlet-content">
            TODO: list hidden agenda items
            </div>
         </div>
    </div>

{% endblock %}
