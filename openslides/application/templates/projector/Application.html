{% extends "base-projector.html" %}

{% load tags %}
{% load i18n %}
{% load staticfiles %}

{% block title %}{{ block.super }} - {%trans "Application" %} {{ application.number }}{% endblock %}
{% block content %}
    <div id="sidebar">
    <div class="box">
        <p><b>{%trans "Status" %}:</b><br>
        {% if application.status != "pub" %}
            {%trans application.get_status_display %}
            <br>
        {% else %}
            {% for note in application.notes %}
            {{ note }}
            {% endfor %}
        {% endif %}
        </p>

        <p><b>{% trans "Submitter" %}:</b><br>
        {{ application.submitter.profile }}</p>
    {% with application.polls as polls %}
    {% if polls.exists and polls.0.has_votes %}
    <p><b>{% trans "Poll result" %}:</b></p>
    {% for poll in polls %}
        {% if poll.has_votes %}
            {% if polls|length > 1 %}
                {{forloop.counter}}. {% trans "Vote" %}:<br>
            {% endif %}
            {% with poll.get_options.0 as option %}
                <img src="{% static 'images/icons/voting-yes.png' %}" title="{% trans 'Yes' %}"> {{ option.Yes }} <br>
                <img src="{% static 'images/icons/voting-no.png' %}" title="{% trans 'No' %}"> {{ option.No }} <br>
                <img src="{% static 'images/icons/voting-abstention.png' %}" title="{% trans 'Abstention' %}">  {{ option.Abstain }}<br>
                <img src="{% static 'images/icons/voting-invalid.png' %}" title="{% trans 'Invalid' %}"> {{ poll.print_votesinvalid }}<br>
                <div style="border-top: 1px solid; padding-top: 5px; margin: 5px 0; width: 10em;">
                    <img src="{% static 'images/icons/voting-total.png' %}" title="{% trans 'Votes cast' %}"> {{ poll.print_votescast }}
                </div>
            {% endwith %}
            <br>
        {% else %}
            {% if poll|length  == 1 %}
            <i>{% trans "No poll results available." %}</i>
            {% endif %}
        {% endif %}
    {% endfor %}
    {% endif %}
    {% endwith %}
    </div>
    </div>

    <h1>
    {% if application.number != None %}
        {% trans "Application No." %} {{ application.number }}
    {% else %}
        {% trans "Application" %} <i>[{% trans "no number" %}]</i>
    {% endif %}
    </h1>
    <h2>{{ application.title }}</h2>
    <b>{{ application.title }}</b>
    <p>
    <div class="text">{{ application.public_version.text|linebreaks }}</div>
    {% if application.public_version.reason %}
        <br>
        <div class="reason"><p><b>{% trans "Reason" %}:</b></p>
        {{ application.public_version.reason|linebreaks }}</div>
    {% endif %}
    </p>
{% endblock %}
